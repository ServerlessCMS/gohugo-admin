webpackJsonp([15],{302:function(t,e,s){s(387);var i=s(0)(s(348),s(403),"data-v-b0936ba6",null);t.exports=i.exports},316:function(t,e,s){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,s,r){e=e||"&",s=s||"=";var n={};if("string"!=typeof t||0===t.length)return n;var o=/\+/g;t=t.split(e);var l=1e3;r&&"number"==typeof r.maxKeys&&(l=r.maxKeys);var c=t.length;l>0&&c>l&&(c=l);for(var u=0;u<c;++u){var d,p,f,h,v=t[u].replace(o,"%20"),m=v.indexOf(s);m>=0?(d=v.substr(0,m),p=v.substr(m+1)):(d=v,p=""),f=decodeURIComponent(d),h=decodeURIComponent(p),i(n,f)?a(n[f])?n[f].push(h):n[f]=[n[f],h]:n[f]=h}return n};var a=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},317:function(t,e,s){"use strict";function i(t,e){if(t.map)return t.map(e);for(var s=[],i=0;i<t.length;i++)s.push(e(t[i],i));return s}var a=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,s,o){return e=e||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t?i(n(t),function(n){var o=encodeURIComponent(a(n))+s;return r(t[n])?i(t[n],function(t){return o+encodeURIComponent(a(t))}).join(e):o+encodeURIComponent(a(t[n]))}).join(e):o?encodeURIComponent(a(o))+s+encodeURIComponent(a(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},n=Object.keys||function(t){var e=[];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.push(s);return e}},318:function(t,e,s){"use strict";e.decode=e.parse=s(316),e.encode=e.stringify=s(317)},348:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(318);e.default={data:function(){return{csrf:"",policies:[],policyRules:"",policyRulesModified:"",loading:!1,nameFilter:"",search:{str:"",found:[],searched:0,regex:!1},selectedPolicy:""}},mounted:function(){var t=this;this.$http.get("/api/policy").then(function(e){t.policies=e.data.result,t.csrf=e.headers["x-csrf-token"]}).catch(function(e){t.$onError(e)})},computed:{filteredPolicies:function(){if(this.nameFilter){var t=this.nameFilter;return this.policies.filter(function(e){return e.includes(t)})}return this.search.searched?this.search.found:this.policies}},methods:{getPolicyRules:function(t){var e=this;this.policyRules="",this.policyRulesModified="",this.selectedPolicy=t,this.$http.get("/api/policy?policy="+t).then(function(t){e.policyRules=t.data.result,e.policyRulesModified=e.policyRules}).catch(function(t){e.$onError(t)})},filterByDetails:function(){var t=this;if(""!==this.search.str){this.search.found=[],this.search.searched=0,this.loading=this.policies.length;for(var e=0;e<this.policies.length;e++)!function(){var s=t.policies[e];t.$http.get("/api/policy?policy="+s).then(function(e){var i=t.search.regex?t.search.str:t.makeRegex(t.search.str);e.data.result.match(i)&&t.search.found.push(s),t.search.searched++,t.loading=t.loading-1||!1}).catch(function(e){t.$onError(e),t.search.searched++,t.loading=t.loading-1||!1})}()}},addPolicyRequest:function(){var t=this;this.$http.post("/api/policy/request?policy="+this.selectedPolicy,i.stringify({rules:this.policyRulesModified}),{headers:{"X-CSRF-Token":this.csrf}}).then(function(e){t.$message({message:"Your change ID is: "+e.data.result,type:"success",duration:0,showCloseButton:!0}),""!==e.data.error&&t.$notify({title:"Slack webhook",message:e.data.error,type:"warning"})}).catch(function(e){t.$onError(e)})},makeRegex:function(t){var e=t.lastIndexOf("/");if(-1===e)for(var s=t,i='"('+t,a=t.length+1;a>0;a--)i+="|"+s+"\\*",s=s.substring(0,a-2);else{if(""===(s=t.substring(e+1,t.length))){var r=t.replace("/","\\/");return'"('+r+"|"+r+'\\*)"'}for(i='"'+t.substring(0,e),i=i.replace("/","\\/")+"\\/("+s,a=s.length+1;a>0;a--)i+="|"+s+"\\*",s=s.substring(0,a-2)}return i+')"'}}}},372:function(t,e,s){e=t.exports=s(295)(),e.push([t.i,".button[data-v-b0936ba6]{margin:5px 0 0}.control .button[data-v-b0936ba6]{margin:inherit}.fa-trash-o[data-v-b0936ba6]{color:red}.fa-info[data-v-b0936ba6]{color:#87cefa}.textarea[data-v-b0936ba6]{height:500px}","",{version:3,sources:["/mnt/windows/shared/workspaces/acentera/serverless-ui/client/views/admin/Policies.vue"],names:[],mappings:"AACA,yBACE,cAAgB,CACjB,AACD,kCACE,cAAgB,CACjB,AACD,6BACE,SAAW,CACZ,AACD,0BACE,aAAoB,CACrB,AACD,2BACE,YAAc,CACf",file:"Policies.vue",sourcesContent:["\n.button[data-v-b0936ba6] {\n  margin: 5px 0 0;\n}\n.control .button[data-v-b0936ba6] {\n  margin: inherit;\n}\n.fa-trash-o[data-v-b0936ba6] {\n  color: red;\n}\n.fa-info[data-v-b0936ba6] {\n  color: lightskyblue;\n}\n.textarea[data-v-b0936ba6] {\n  height: 500px;\n}\n"],sourceRoot:""}])},387:function(t,e,s){var i=s(372);"string"==typeof i&&(i=[[t.i,i,""]]);s(296)(i,{});i.locals&&(t.exports=i.locals)},403:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"tile is-ancestor is-vertical"},[s("div",{staticClass:"tile is-parent"},[s("article",{staticClass:"tile is-child box"},[s("nav",{staticClass:"level"},[s("div",{staticClass:"level-left"},[s("div",{staticClass:"level-item"},[s("p",{staticClass:"control has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.nameFilter,expression:"nameFilter"}],staticClass:"input",attrs:{type:"text",placeholder:"Filter by policy name"},domProps:{value:t.nameFilter},on:{input:function(e){e.target.composing||(t.nameFilter=e.target.value)}}}),t._v(" "),t._m(0)])])]),t._v(" "),s("div",{staticClass:"level-item"},[s("p",{staticClass:"subtitle is-5"},[t._v("\n              Displaying "),s("strong",[t._v(" "+t._s(t.filteredPolicies.length)+" ")]),t._v(" out of "),s("strong",[t._v(t._s(t.policies.length))]),t._v(" policies\n            ")])]),t._v(" "),s("div",{staticClass:"level-right"},[s("div",{staticClass:"level-item"},[s("div",{staticClass:"field has-addons"},[s("p",{staticClass:"control has-icons-right"},[s("span",{staticClass:"select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.search.regex,expression:"search.regex"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.search.regex=e.target.multiple?s:s[0]}}},[s("option",{domProps:{value:!1}},[t._v("Smart Search")]),t._v(" "),s("option",{domProps:{value:!0}},[t._v("Regex")])])])]),t._v(" "),s("p",{staticClass:"control"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.search.str,expression:"search.str"}],staticClass:"input",attrs:{type:"text",placeholder:t.search.regex?"Filter by policy details":"foo/bar matches foo/*"},domProps:{value:t.search.str},on:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13))return null;t.filterByDetails()},input:function(e){e.target.composing||(t.search.str=e.target.value)}}})]),t._v(" "),s("p",{staticClass:"control"},[s("button",{staticClass:"button is-info",class:t.loading?"is-loading":"",on:{click:function(e){t.filterByDetails()}}},[t._v("\n                    Search\n                  ")])])])])])])])]),t._v(" "),s("div",{staticClass:"tile is-parent is-marginless is-paddingless"},[s("div",{staticClass:"tile is-parent is-child is-vertical is-5"},[s("article",{staticClass:"tile is-child box"},[s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table is-striped is-narrow"},[t._m(1),t._v(" "),s("tbody",t._l(t.filteredPolicies,function(e,i){return s("tr",[s("td",{attrs:{width:"34"}},[s("span",{staticClass:"icon"},[s("a",{on:{click:function(s){t.getPolicyRules(e)}}},[s("i",{staticClass:"fa fa-info"})])])]),t._v(" "),s("td",[t._v("\n                    "+t._s(e)+"\n                  ")])])}))])])])]),t._v(" "),s("div",{staticClass:"tile is-parent is-vertical"},[s("article",{staticClass:"tile is-child box"},[s("h4",{staticClass:"title is-4"},[t._v("Policy Rules")]),t._v(" "),s("div",{staticClass:"field"},[s("p",{staticClass:"control"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.policyRulesModified,expression:"policyRulesModified"}],staticClass:"textarea",attrs:{placeholder:"Select a policy"},domProps:{value:t.policyRulesModified},on:{input:function(e){e.target.composing||(t.policyRulesModified=e.target.value)}}})])]),t._v(" "),s("div",{staticClass:"field"},[s("p",{staticClass:"control is-pulled-right"},[s("a",{staticClass:"button is-primary is-outlined",attrs:{disabled:t.policyRules===t.policyRulesModified},on:{click:function(e){t.addPolicyRequest()}}},[s("span",[t._v("Request changes")]),t._v(" "),t._m(2)])])])])])])])])},staticRenderFns:[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fa fa-search"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("th"),t._v(" "),s("th",[t._v("Policy Name")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",{staticClass:"icon is-small"},[s("i",{staticClass:"fa fa-check"})])}]}}});
//# sourceMappingURL=15.js.map